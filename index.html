<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate fishery composition data from PacFIN data for the NWFSC • pacfintools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Generate fishery composition data from PacFIN data for the NWFSC">
<meta property="og:description" content="Manipulates data from the PacFIN database for stock assessment models">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">pacfintools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/sablefish_example.html">Working through sablefish PacFIN data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="pacfintools">pacfintools<a class="anchor" aria-label="anchor" href="#pacfintools"></a>
</h1></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Age-structured stock assessment models were developed to reconstruct historical abundance from age-, length-, and weight-composition data as well as other inputs. Data are often provided for individual fish, and these data must be summarized by year or season to be of use as input to a stock assessment model. These data provide information on growth, cohort strength, and fleet-specific selectivity. <code>pacfintools</code> offers a framework to summarize information collected from individual fish off of the U.S. West Coast and available within the Pacific Fisheries Information Network (PacFIN) that can easily be used as input for Stock Synthesis (SS3). Specifically, the framework</p>
<ul>
<li>filters the raw data stored in PacFIN,</li>
<li>expands samples taken from a tow to the trip level,</li>
<li>expands trips for a given state to state-specific catches, and</li>
<li>provides year-specific sample sizes and summaries of fish-specific data as yearly, fishery-specific compositions.</li>
</ul>
<p>Note: this package was named <code>PacFIN.Utilities</code> prior to January 2025.</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>Data collection programs for groundfish managed within the Pacific Fisheries Management Council (PFMC) are the responsibility of individual states. Washington and Oregon have mandatory sampling protocols, while sampling in California was not mandatory prior to October 10, 2021. These programs have largely been in existence since the 1960s. PacFIN, which was initiated in 1981, serves as a central repository for these data. For fish landed whole, fork or total length and sex are typically recorded at a minimum. Otoliths are sometimes extracted and weights are sometimes taken. For fish landed dressed, dorsal length is taken rather than fork length (or total length). Samples can be taken from unsorted landings (i.e., ‘ocean run’) or from sorted categories (e.g., small, medium, large, …). When fish are sorted into categories, samples are in theory taken from each sorted group and the actual weight of the sorted group is recorded. Data within PacFIN contains a range of fields that provides information on each specific record: <a href="https://pacfin.psmfc.org/pacfin_pub/data_rpts_pub/code_lists/ar.txt" class="external-link">area of landing</a>, <a href="https://pacfin.psmfc.org/pacfin_pub/data_rpts_pub/code_lists/gr.txt" class="external-link">gear type</a>, <a href="https://pacfin.psmfc.org/pacfin_pub/data_rpts_pub/code_lists/pc.txt" class="external-link">port</a>, <a href="https://pacfin.psmfc.org/pacfin_pub/data_rpts_pub/code_lists/list_cl_condition.txt" class="external-link">the condition landed (e.g., live, dead, dressed)</a>, and <a href="https://pacfin.psmfc.org/pacfin_pub/data_rpts_pub/code_lists/list_cl_removal_type.txt" class="external-link">the removal type (e.g., commercial, research)</a>. All records within PacFIN are associated with a unique species code <a href="https://pacfin.psmfc.org/pacfin_pub/data_rpts_pub/code_lists/sp.txt" class="external-link">SPID</a>.</p>
</div>
<div class="section level2">
<h2 id="filtering">Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h2>
<div class="section level3">
<h3 id="agencies">Agencies<a class="anchor" aria-label="anchor" href="#agencies"></a>
</h3>
<p>All samples from agencies other than Washington, Oregon, and California, i.e, tribal sampling, are removed.</p>
</div>
<div class="section level3">
<h3 id="sampling">Sampling<a class="anchor" aria-label="anchor" href="#sampling"></a>
</h3>
<p>Random sampling method is the preferred sampling method. Market samples are the preferred sampling type.</p>
</div>
<div class="section level3">
<h3 id="ages">Ages<a class="anchor" aria-label="anchor" href="#ages"></a>
</h3>
<p>Ages are first taken from the best age available and then from age readers one to three in that order. These subsequent ages are only used if the previous age is <code>NA</code>.</p>
</div>
<div class="section level3">
<h3 id="lengths">Lengths<a class="anchor" aria-label="anchor" href="#lengths"></a>
</h3>
<p>Fork length is the primary length type used if available. Secondarily, standard length and then total length become the measurement of choice.</p>
<div class="section level4">
<h4 id="other-length-types">Other length types<a class="anchor" aria-label="anchor" href="#other-length-types"></a>
</h4>
<p>For other length types, i.e., dorsal, unknown, pacfintools will first look to see if there is a valid fork length. Second, if there is not a fork-length measurement then it will use the general length information provided.</p>
</div>
<div class="section level4">
<h4 id="skates">Skates<a class="anchor" aria-label="anchor" href="#skates"></a>
</h4>
<p>Skates are unique in that lengths are not typically collected. Instead, inter-spiracle widths, collected by Washington, and disk widths are converted to lengths.</p>
</div>
</div>
<div class="section level3">
<h3 id="oregon-special-permit-samples">Oregon special-permit samples<a class="anchor" aria-label="anchor" href="#oregon-special-permit-samples"></a>
</h3>
<p>Many samples were collected by Oregon using non-traditional sampling protocols in an effort to gain extra information about groundfish. For example, the Marine Recreational Information Program funded the collection of additional samples during the winter of 2011-2012. These ‘special-permit’ samples often do not collect all of the standard information collected by Oregon in their groundfish sampling program but they can provide additional auxiliary information for research topics related to but not directly informing stock assessments.</p>
<p>On March 19, 2019, Oregon made a correction to PacFIN that properly designated a collection of special-permit samples as SPxxx samples rather than ORxxx samples. The SPxxx sample number provides a flag to stock assessment scientists that the sample should not be used. Prior to 2019, these samples from the late 1970s and early 1980s were included in the data utilized from PacFIN for age and length compositions. The incorrect sample numbers can be found in the object labeled <code>badORnums</code>.</p>
</div>
<div class="section level3">
<h3 id="sample-weights">Sample weights<a class="anchor" aria-label="anchor" href="#sample-weights"></a>
</h3>
<p>Oregon and California have gone to great lengths to provide correct species-specific weights of samples. This information is stored in <code>Pdata[, "EXP_WT"]</code> and <code>Pdata[, "SPECIES_WGT"]</code>, respectively. All Oregon and California samples that are missing this information are removed from the data set expanded to create compositions.</p>
</div>
</div>
<div class="section level2">
<h2 id="expansion">Expansion<a class="anchor" aria-label="anchor" href="#expansion"></a>
</h2>
<p>Expansions are performed to account for fish that were not sampled or when sampling is unequal across stratums. Expansions are calculated twice, first for fish with lengths and second for fish with ages because less fish are typically aged than lengthed and weights used for the expansions should only include fish that provide information. For example, if 10 fish were lengthed but only five fish were aged the expansion for the ages should only be based on the weight of the aged fish.</p>
<div class="section level3">
<h3 id="stage-1-expansion">Stage-1 expansion<a class="anchor" aria-label="anchor" href="#stage-1-expansion"></a>
</h3>
<p>The stage-1 expansion is performed to account for fish that are not sampled in a given tow or trip. Sampled fish are thought to be representative of all fish within a tow. Thus, if only a few fish are sampled from a very large tow, these few samples will be expanded to represent a larger portion of the population than a sample consisting of the same or fewer number of fish that were sampled from a tow that wasn’t as heavy. The expansion factor is the ratio of the weight of fish that were landed in the tow or trip to the weight of fish within that tow or trip that were sampled.</p>
<div class="section level4">
<h4 id="tow-or-trip-weight">Tow or trip weight<a class="anchor" aria-label="anchor" href="#tow-or-trip-weight"></a>
</h4>
<p>Unfortunately, the species-specific weight for a given tow or trip is not always recorded and states report the measurement in the following ways:</p>
<div class="section level5">
<h5 id="washington">Washington<a class="anchor" aria-label="anchor" href="#washington"></a>
</h5>
<ul>
<li>Round weight is the preferred measurement to account for the weight of fish that were dressed prior to weighing.</li>
<li>Total weight is used if round weight is not available.</li>
<li>Year- and gear-specific median tow or trip round weights are assigned to all samples that don’t have a tow or trip weight.</li>
<li>Year- and gear-specific median tow or trip total weights are assigned to all samples that don’t have a tow or trip weight.</li>
</ul>
</div>
<div class="section level5">
<h5 id="oregon">Oregon<a class="anchor" aria-label="anchor" href="#oregon"></a>
</h5>
<ul>
<li>
<code>EXP_WT</code> is provided by Oregon as a measure of the weight the sample should be expanded to and defaults to the landing weight.</li>
<li>Years prior to 1973 are often missing <code>EXP_WT</code>, and for these instances, the weight is calculated in the same manner as the default method for California.</li>
<li>Year- and gear-specific median tow or trip total weights are assigned to all samples that don’t have a tow or trip weight.</li>
</ul>
</div>
<div class="section level5">
<h5 id="california">California<a class="anchor" aria-label="anchor" href="#california"></a>
</h5>
<ul>
<li>The tow or trip weight, which includes the weight of all fish within a tow or trip that represent species that were sampled and can include species other than the species of concern, is multiplied by the ratio of the weight of the species of concern in the sample to the weight of the sample to get the fraction of the sample that contained the species of concern. It is assumed that the tow will be of this same ratio.</li>
<li>Year- and gear-specific median tow or trip total weights are assigned to all samples that don’t have a tow or trip weight.</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="sampled-fish-weight">Sampled fish weight<a class="anchor" aria-label="anchor" href="#sampled-fish-weight"></a>
</h4>
<p>Weights of the sample are found using the following three methods:</p>
<ol style="list-style-type: decimal">
<li>Oregon provides the total weight of males, females, and unsexed fish within a given sample; these are summed to calculate the weight of all fish within the sample.</li>
<li>The species-specific weight for the species of concern within that sample is provided by California as <code>SPECIES_WGT</code>.</li>
<li>The weight of all fish within the sample are summed. Fish weights are preferably empirically measured weights and secondarily calculated using a weight–length relationship. For fish in a sample without a length, the median length of all fish within the sample is used.</li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="stage-2-expansion">Stage-2 expansion<a class="anchor" aria-label="anchor" href="#stage-2-expansion"></a>
</h3>
<p>The stage-2 expansion typically operates at the state x gear x year level. Regardless, whatever level the stratum are defined at, the expansion is the ratio of the landings to the weight of fish that were sampled from those landings.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pacfintools</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Chantel R. Wetzel <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7573-8240" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Ian G. Taylor <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-4232-5669" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Kelli F. Johnson <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5149-451X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Chantel R. Wetzel, Ian G. Taylor, Kelli F. Johnson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
